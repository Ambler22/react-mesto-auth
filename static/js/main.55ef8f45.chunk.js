(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{29:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),s=n(19),o=n.n(s),i=n(8),r=(n(29),n(23)),l=n(3),u=n(2),d=n.p+"static/media/header.03b78ada.svg",j=n(0);var p=function(e){return Object(j.jsxs)("header",{className:"header page__content",children:[Object(j.jsx)("img",{src:d,className:"header__logo",alt:"\u043b\u043e\u0433\u043e\u0442\u0438\u043f"}),Object(j.jsx)("div",{className:"header__elements",children:Object(j.jsxs)(u.d,{children:[Object(j.jsxs)(u.b,{exact:!0,path:"/",children:[Object(j.jsx)("p",{className:"header__email",children:e.email}),Object(j.jsx)(i.b,{to:"/sign-in",className:"header__button",onClick:e.signOut,children:"\u0412\u044b\u0439\u0442\u0438"})]}),Object(j.jsx)(u.b,{puth:"/sign-in",children:Object(j.jsx)(i.b,{to:"sign-up",className:"header__button",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})}),Object(j.jsx)(u.b,{puth:"/sign-up",children:Object(j.jsx)(i.b,{to:"sign-in",className:"header__button",children:"\u0412\u043e\u0439\u0442\u0438"})})]})})]})},h=n(12),m=c.a.createContext();var b=function(e){var t=c.a.useContext(m),n=e.owner._id===t._id,a="card__delete ".concat(n?"card__delete":"card__delete_none"),s=e.likes.some((function(e){return e._id===t._id})),o="card__like ".concat(s?"card__like_active":"");return Object(j.jsx)("div",{className:"card",children:Object(j.jsxs)("div",{className:"card",children:[Object(j.jsx)("button",{type:"button",className:"".concat(a," hover"),onClick:function(){e.onCardDelete(e)}}),Object(j.jsx)("img",{src:e.link,className:"card__img",alt:e.name,onClick:function(){e.onCardClick(e)}}),Object(j.jsxs)("div",{className:"card__description",children:[Object(j.jsx)("h2",{className:"card__text",children:e.name}),Object(j.jsxs)("div",{className:"",children:[Object(j.jsx)("button",{type:"button",className:o,onClick:function(){e.onCardLike(e)},"aria-label":"\u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f"}),Object(j.jsx)("p",{className:"card__like_number"})]})]})]})},e.id)};var f=function(e){var t=c.a.useContext(m);return Object(j.jsxs)("main",{children:[Object(j.jsxs)("section",{className:"profile page__content",children:[Object(j.jsxs)("div",{className:"profile__info",children:[Object(j.jsx)("div",{className:"profile__avatar-icon",onClick:e.onEditAvatar,children:Object(j.jsx)("img",{src:t.avatar,className:"profile__avatar",alt:"\u0410\u0432\u0430\u0442\u0430\u0440"})}),Object(j.jsxs)("div",{className:"profile__content",children:[Object(j.jsxs)("div",{className:"profile__add",children:[Object(j.jsx)("h1",{className:"profile__name",children:t.name}),Object(j.jsx)("button",{type:"button",className:"profile__edit hover",onClick:e.onEditProfile})]}),Object(j.jsx)("p",{className:"profile__jod",children:t.about})]})]}),Object(j.jsx)("button",{type:"button",className:"profile__button hover",onClick:e.onAddPlace})]}),Object(j.jsx)("section",{className:"cards page__content"}),Object(j.jsx)("section",{className:"cards page__content",children:e.cards.map((function(t){return Object(j.jsx)(b,Object(h.a)(Object(h.a)({},t),{},{onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete}),t._id)}))})]})};var _=function(){return Object(j.jsx)("footer",{className:"footer page__content",children:Object(j.jsxs)("p",{className:"footer__copyright",children:["\xa9 ",(new Date).getFullYear()," \u0414\u0440\u043e\u0437\u0434\u043e\u0432 \u0420\u043e\u043c\u0430\u043d"]})})};var O=function(e){return Object(j.jsx)("div",{className:"popup ".concat(e.isOpen&&"popup_is-opened"),children:Object(j.jsxs)("div",{className:"popup__content",children:[Object(j.jsx)("h2",{className:"popup__title",children:e.title}),Object(j.jsx)("form",{onSubmit:e.onSubmit,action:"#",name:"form-".concat(e.name),className:"form form-".concat(e.name),noValidate:!0,children:Object(j.jsxs)("fieldset",{className:"form-container",children:[e.children,Object(j.jsx)("button",{type:"submit",className:"form-container__button form-container__button_".concat(e.name," popup__load"),children:e.buttonText})]})}),Object(j.jsx)("button",{type:"button",className:"popup__img-close hover",onClick:e.onClose})]})})};var x=function(e){var t=c.a.useRef();return Object(j.jsxs)(O,{name:"avatar_update",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},children:[Object(j.jsx)("input",{id:"avatarurl",type:"url",name:"link",className:"form-container__input form-container__input_".concat(e.name),placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",tabIndex:"2",required:!0,ref:t}),Object(j.jsx)("span",{className:"form-container__input-error",id:"avatarurl-error"})]})};var g=function(e){var t=c.a.useContext(m),n=c.a.useState(""),a=Object(l.a)(n,2),s=a[0],o=a[1],i=c.a.useState(""),r=Object(l.a)(i,2),u=r[0],d=r[1];return c.a.useEffect((function(){o(t.name),d(t.about)}),[t,e.isOpen]),Object(j.jsxs)(O,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:s,about:u})},children:[Object(j.jsx)("input",{id:"".concat(e.name,"name"),type:"text",name:"name",className:"form-container__input",required:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f",tabIndex:"1",minLength:"2",maxLength:"40",placeholder:"\u0418\u043c\u044f",value:s||"",onChange:function(e){o(e.target.value)}}),Object(j.jsx)("span",{className:"form-container__input-error",id:"".concat(e.name,"name-error")}),Object(j.jsx)("input",{id:"".concat(e.name,"description"),type:"text",name:"description",className:"form-container__input",required:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",tabIndex:"2",minLength:"2",maxLength:"200",placeholder:"\u0417\u0430\u043d\u044f\u0442\u0438\u0435",value:u||"",onChange:function(e){d(e.target.value)}}),Object(j.jsx)("span",{className:"form-container__input-error",id:"".concat(e.name,"description-error")})]})};var v=function(e){var t=c.a.useRef(),n=c.a.useRef();return Object(j.jsxs)(O,{name:"cards",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(a){a.preventDefault(),e.onAddPlace({name:t.current.value,link:n.current.value})},children:[Object(j.jsx)("input",{id:"".concat(e.name,"name"),type:"text",name:"name",className:"form-container__input form-container__input_title",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",tabIndex:"1",minLength:"2",maxLength:"30",required:!0,ref:t}),Object(j.jsx)("span",{className:"form-container__input-error",id:"".concat(e.name,"name-error")}),Object(j.jsx)("input",{id:"".concat(e.name,"url"),type:"url",name:"link",className:"form-container__input form-container__input_image",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",tabIndex:"2",required:!0,ref:n}),Object(j.jsx)("span",{className:"form-container__input-error",id:"".concat(e.name,"url-error")})]})};var N=function(e){return Object(j.jsx)(O,{name:"cards_delete",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonText:"\u0414\u0430"})};var C=function(e){return Object(j.jsx)("div",{className:"popup popup-image ".concat(e.card.name&&"popup_is-opened"),onClose:e.onClose,children:Object(j.jsxs)("div",{className:"popup-image__content",children:[Object(j.jsx)("img",{src:e.card.link,className:"popup-image__photo",alt:e.card.name}),Object(j.jsx)("h2",{className:"popup-image__title",children:e.card.name}),Object(j.jsx)("button",{type:"button",className:"popup__img-close hover",onClick:e.onClose})]})})},k=n(21),y=n(22),S=new(function(){function e(t){Object(k.a)(this,e),this.url=t.url,this.headers=t.headers}return Object(y.a)(e,[{key:"_getResponseData",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getUserInfo",value:function(){var e=this;return fetch("".concat(this.url,"/users/me"),{headers:this.headers}).then((function(t){return e._getResponseData(t)}))}},{key:"getCards",value:function(){var e=this;return fetch("".concat(this.url,"/cards"),{headers:this.headers}).then((function(t){return e._getResponseData(t)}))}},{key:"setUserInfo",value:function(e){var t=this;return fetch("".concat(this.url,"/users/me"),{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e.name,about:e.about})}).then((function(e){return t._getResponseData(e)}))}},{key:"setUserAvatar",value:function(e){var t=this;return fetch("".concat(this.url,"/users/me/avatar"),{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then((function(e){return t._getResponseData(e)}))}},{key:"setCards",value:function(e){var t=this;return fetch("".concat(this.url,"/cards"),{method:"POST",headers:this.headers,body:JSON.stringify({name:e.name,link:e.link})}).then((function(e){return t._getResponseData(e)}))}},{key:"deleteCard",value:function(e){var t=this;return fetch("".concat(this.url,"/cards/").concat(e),{method:"DELETE",headers:this.headers}).then((function(e){return t._getResponseData(e)}))}},{key:"setLike",value:function(e){var t=this;return fetch("".concat(this.url,"/cards/likes/").concat(e),{method:"PUT",headers:this.headers}).then((function(e){return t._getResponseData(e)}))}},{key:"deleteLike",value:function(e){var t=this;return fetch("".concat(this.url,"/cards/likes/").concat(e),{method:"DELETE",headers:this.headers}).then((function(e){return t._getResponseData(e)}))}}]),e}())({url:"https://nomoreparties.co/v1/cohort-25",headers:{authorization:"2db1777b-72eb-4863-bc5d-c00b58939d4b","Content-Type":"application/json"}});var D=function(e){var t=c.a.useState(""),n=Object(l.a)(t,2),a=n[0],s=n[1],o=c.a.useState(""),i=Object(l.a)(o,2),r=i[0],u=i[1];return Object(j.jsxs)("div",{className:"login",children:[Object(j.jsx)("h1",{className:"login__title",children:"\u0412\u0445\u043e\u0434"}),Object(j.jsxs)("form",{className:"login__form",onSubmit:function(t){t.preventDefault();var n=a,c=r;e.authorization(n,c)},children:[Object(j.jsx)("input",{className:"login__input",placeholder:"Email",value:a,onChange:function(e){s(e.target.value)}}),Object(j.jsx)("input",{className:"login__input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:r,onChange:function(e){u(e.target.value)}}),Object(j.jsx)("button",{className:"login__button",type:"submit",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})};var L=function(e){console.log("123");var t=c.a.useState(""),n=Object(l.a)(t,2),a=n[0],s=n[1],o=c.a.useState(""),r=Object(l.a)(o,2),u=r[0],d=r[1];return Object(j.jsxs)("div",{className:"register",children:[Object(j.jsx)("h1",{className:"register__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(j.jsxs)("form",{className:"register__form",onSubmit:function(t){t.preventDefault();var n=a,c=u;e.registration(n,c)},children:[Object(j.jsx)("input",{className:"register__input",placeholder:"Email",value:a,onChange:function(e){s(e.target.value)}}),Object(j.jsx)("input",{className:"register__input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:u,onChange:function(e){d(e.target.value)}}),Object(j.jsx)("button",{className:"register__button",type:"submit",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]}),Object(j.jsx)(i.b,{className:"register__link",to:"/sign-in",children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0412\u043e\u0439\u0442\u0438"})]})},I=n(24),P=["isLoggedIn"];var T=function(e){var t=e.isLoggedIn,n=Object(I.a)(e,P);return t?Object(j.jsx)(u.b,Object(h.a)({},n)):Object(j.jsx)(u.a,{to:"/sign-in"})};var E=function(e){return Object(j.jsx)("div",{className:"popup popup-notify ".concat(e.isOpen&&"popup_is-opened"),children:Object(j.jsxs)("div",{className:"popup__content",children:[Object(j.jsx)("img",{className:"popup-notify__img",src:e.notifyPopupInfo.image,alt:""}),Object(j.jsx)("h2",{className:"popup-notify__title",children:e.notifyPopupInfo.title}),Object(j.jsx)("button",{type:"button",className:"popup__img-close hover",onClick:e.onClose})]})})},A="https://auth.nomoreparties.co",U=n.p+"static/media/success.1b6082f8.svg",R=n.p+"static/media/fail.df8eddf6.svg";var w=function(){var e=Object(u.g)(),t=c.a.useState({}),n=Object(l.a)(t,2),a=n[0],s=n[1],o=c.a.useState(!1),i=Object(l.a)(o,2),d=i[0],h=i[1],b=c.a.useState(!1),O=Object(l.a)(b,2),k=O[0],y=O[1],I=c.a.useState(!1),P=Object(l.a)(I,2),w=P[0],J=P[1],q=c.a.useState(!1),F=Object(l.a)(q,2),z=F[0],B=F[1],H=c.a.useState({}),G=Object(l.a)(H,2),V=G[0],Y=G[1],K=c.a.useState({}),M=Object(l.a)(K,2),Q=M[0],W=M[1],X=c.a.useState([]),Z=Object(l.a)(X,2),$=Z[0],ee=Z[1],te=c.a.useState(!1),ne=Object(l.a)(te,2),ae=ne[0],ce=ne[1],se=c.a.useState(""),oe=Object(l.a)(se,2),ie=oe[0],re=oe[1];function le(){B(!0)}function ue(e){var t=e.path,n=e.text;Y({image:t,title:n})}function de(){y(!1),h(!1),J(!1),B(!1),W({})}return c.a.useEffect((function(){Promise.all([S.getUserInfo(),S.getCards()]).then((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];s(n),ee(a)})).catch((function(e){console.log(e)}))}),[]),c.a.useEffect((function(){var t,n=localStorage.getItem("jwt");n&&(t=n,fetch("".concat(A,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).then((function(e){return e}))).then((function(t){t&&re(t.data.email),ce(!0),e.push("/")})).catch((function(e){console.log(e)}))}),[ae,e]),Object(j.jsx)(m.Provider,{value:a,children:Object(j.jsxs)("div",{className:"page",children:[Object(j.jsx)(p,{email:ie,signOut:function(){localStorage.removeItem("jwt"),e.push("/sign-in")}}),Object(j.jsxs)(u.d,{children:[Object(j.jsx)(u.b,{path:"/sign-in",children:Object(j.jsx)(D,{authorization:function(t,n){!function(e,t){fetch("".concat(A,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()})).then((function(e){if(e.token)return localStorage.setItem("jwt",e.token),e.token})).catch((function(e){return console.log(e)}))}(t,n),t!==ie&&re(t),ce(!0),e.push("/")}})}),Object(j.jsx)(u.b,{path:"/sign-up",children:Object(j.jsx)(L,{registration:function(e,t){(function(e,t){return fetch("".concat(A,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})})})(e,t).then((function(){ue({path:U,text:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!"}),le()})).catch((function(e){ue({path:R,text:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."}),le(),console.log(e)}))}})}),Object(j.jsxs)(u.b,{puth:"/",children:[" ",ae?Object(j.jsx)(u.a,{to:"/"}):Object(j.jsx)(u.a,{to:"sign-in"})," "]}),Object(j.jsx)(T,{exact:!0,path:"/",isLoggedIn:ae,component:f,onEditAvatar:function(){y(!0)},onEditProfile:function(){h(!0)},onAddPlace:function(){J(!0)},onCardClick:function(e){W({name:e.name,link:e.link})},cards:$,onCardLike:function(e){(e.likes.some((function(e){return e._id===a._id}))?S.deleteLike(e._id):S.setLike(e._id)).then((function(t){ee((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){console.log(e)}))},onCardDelete:function(e){S.deleteCard(e._id).then((function(){ee((function(t){return t.filter((function(t){return t._id!==e._id}))}))})).catch((function(e){console.log(e)}))}})]}),Object(j.jsx)(_,{}),Object(j.jsx)(g,{isOpen:d,onClose:de,onUpdateUser:function(e){S.setUserInfo(e).then((function(e){s(e),de()})).catch((function(e){console.log(e)}))}}),Object(j.jsx)(v,{isOpen:w,onClose:de,onAddPlace:function(e){S.setCards(e).then((function(e){ee([e].concat(Object(r.a)($))),de()})).catch((function(e){console.log(e)}))}}),Object(j.jsx)(C,{card:Q,onClose:de}),Object(j.jsx)(N,{}),Object(j.jsx)(x,{isOpen:k,onClose:de,onUpdateAvatar:function(e){var t=e.avatar;S.setUserAvatar(t).then((function(e){s(e),de()})).catch((function(e){console.log(e)}))}}),Object(j.jsx)(E,{isOpen:z,onClose:de,notifyPopupInfo:V})]})})},J=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),s(e),o(e)}))};o.a.render(Object(j.jsx)(i.a,{children:Object(j.jsx)(w,{})}),document.getElementById("root")),J()}},[[36,1,2]]]);
//# sourceMappingURL=main.55ef8f45.chunk.js.map